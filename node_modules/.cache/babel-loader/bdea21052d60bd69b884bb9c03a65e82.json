{"ast":null,"code":"var _jsxFileName = \"/Users/kittabit/Desktop/occasiongenius/src/Pages/Events.js\";\nimport React, { Component } from 'react';\nimport Loading from \"../Components/Loading\";\nimport Breadcrumbs from \"../Components/Breadcrumbs\";\nimport EventFilter from '../Components/EventFilter';\nimport EventGridItem from '../Components/EventGridItem';\nimport ReactGA from 'react-ga';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nclass Events extends Component {\n  constructor(props) {\n    if (window.ogSettings.environment === \"dev\") {\n      var api_base_url = \"http://127.0.0.1:3000\";\n    } else {\n      var api_base_url = \"https://widgetapi.occasiongenius.com\";\n    }\n\n    super(props);\n\n    this.fetchData = async url => {\n      this.setState({\n        isLoading: 1\n      });\n      await fetch(this.props.api_base_url + this.state.events_url).then(r => r.json()).then(result => {\n        this.setState({\n          events: result,\n          current_page: result.info.current_page,\n          next_page: result.info.next_page,\n          max_pages: result.info.max_pages,\n          isLoading: 0\n        });\n      }).catch(e => {\n        console.log(e);\n      });\n    };\n\n    this.nextPage = () => {\n      this.setState({\n        current_page: this.state.current_page + 1,\n        isLoading: 1\n      }, () => {\n        const events_url = this.props.api_base_url + this.state.events_url + this.state.current_page;\n        this.fetchData(events_url);\n        window.scrollTo({\n          top: 0,\n          behavior: \"smooth\"\n        });\n      });\n    };\n\n    this.prevPage = () => {\n      this.setState({\n        current_page: this.state.current_page - 1,\n        isLoading: 1\n      }, () => {\n        const events_url = this.props.api_base_url + this.state.events_url + this.state.current_page;\n        this.fetchData(events_url);\n        window.scrollTo({\n          top: 0,\n          behavior: \"smooth\"\n        });\n      });\n    };\n\n    this.handleCategories = e => {\n      let value = Array.from(e.target.selectedOptions, option => option.value);\n      this.setState({\n        filter_categories: value\n      });\n    };\n\n    this.handleAreas = e => {\n      let value = Array.from(e.target.selectedOptions, option => option.value);\n      this.setState({\n        filter_areas: value\n      });\n    };\n\n    this.state = {\n      api_base_url: api_base_url,\n      current_page: [],\n      next_page: [],\n      max_pages: [],\n      events: [],\n      events_url: '/api/events/',\n      isLoading: 1,\n      start_date: window.ogSettings.og_base_date,\n      end_date: window.ogSettings.og_max_base_date,\n      min_date: window.ogSettings.og_min_base_date,\n      max_date: window.ogSettings.og_max_base_date,\n      filter_categories: '',\n      filter_areas: ''\n    };\n    this.handleStartDate = this.handleStartDate.bind(this);\n    this.handleEndDate = this.handleEndDate.bind(this);\n    this.handleCategories = this.handleCategories.bind(this);\n    this.handleAreas = this.handleAreas.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  componentDidMount() {\n    console.log(this.props.api_base_url + this.state.events_url);\n    Promise.all([fetch(this.props.api_base_url + this.state.events_url)]).then(_ref => {\n      let [res] = _ref;\n      return Promise.all([res.json()]);\n    }).then(_ref2 => {\n      let [cat_data] = _ref2;\n      return this.setState({\n        events: cat_data,\n        current_page: cat_data.info.current_page,\n        next_page: cat_data.info.next_page,\n        max_pages: cat_data.info.max_pages,\n        isLoading: 0\n      });\n    });\n    document.title = \"All Local Events\";\n\n    if (window.ogSettings.og_ga_ua) {\n      ReactGA.pageview(window.location.pathname + window.location.search);\n    }\n  }\n\n  handleStartDate(event) {\n    this.setState({\n      start_date: event.target.value,\n      min_date: event.target.value\n    });\n  }\n\n  handleEndDate(event) {\n    this.setState({\n      end_date: event.target.value\n    });\n  }\n\n  handleSubmit(event) {\n    var fetch_url = \"/wp-json/occasiongenius/v1/events?limit=100&filter_start=\" + this.state.start_date + \"&filter_end=\" + this.state.end_date + \"&filter_flags=\" + this.state.filter_categories + \"&filter_areas=\" + this.state.filter_areas;\n    console.log(\":: Fetch: \" + fetch_url);\n    this.fetchData(fetch_url);\n    window.scrollTo({\n      top: 0,\n      behavior: \"smooth\"\n    });\n    event.preventDefault();\n  }\n\n  render() {\n    var _this$state$events;\n\n    console.table(this.state.events);\n    const {\n      current_page,\n      next_page,\n      max_pages\n    } = this.state;\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Breadcrumbs, {\n        parent_title: \"All Categories\",\n        parent_url: \"/categories/\",\n        page_name: \"All Local Events\",\n        disable_all_events: \"true\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"col-span-12\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flow-root\",\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"float-left text-gray-800 text-3xl font-semibold mb-4\",\n            children: \"All Local Events\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 173,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex w-full flex-wrap\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-col md:w-1/5\",\n          children: /*#__PURE__*/_jsxDEV(EventFilter, {\n            fetchData: this.fetchData,\n            handleStartDate: this.handleStartDate,\n            handleEndDate: this.handleEndDate,\n            handleCategories: this.handleCategories,\n            handleAreas: this.handleAreas,\n            handleSubmit: this.handleSubmit,\n            start_date: this.state.start_date,\n            end_date: this.state.end_date,\n            min_date: this.state.min_date,\n            max_date: this.state.max_date\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 182,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-col md:w-4/5 items-center\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"grid grid-cols-12 px-18 gap-5\",\n            children: this.state.isLoading ? /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 199,\n              columnNumber: 33\n            }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n              children: (_this$state$events = this.state.events) === null || _this$state$events === void 0 ? void 0 : _this$state$events.map((item, index) => /*#__PURE__*/_jsxDEV(EventGridItem, {\n                item: item\n              }, index, false, {\n                fileName: _jsxFileName,\n                lineNumber: 203,\n                columnNumber: 41\n              }, this))\n            }, void 0, false)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 197,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 196,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-6 lg:space-x-8 mt-8 md:mt-16 mt-16\",\n        children: [current_page > 1 && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: this.prevPage,\n            className: \"block w-full md:w-3/5 border border-gray-800 text-base font-medium leading-none text-white uppercase py-6 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-800 bg-gray-800 hover:text-white no-underline text-center\",\n            children: \"Previous Page\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 214,\n            columnNumber: 29\n          }, this)\n        }, void 0, false), next_page <= max_pages && max_pages !== current_page && /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: this.nextPage,\n            className: \"block w-full md:w-3/5 border border-gray-800 text-base font-medium leading-none text-white uppercase py-6 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-800 bg-gray-800 hover:text-white no-underline text-center\",\n            children: \"Next Page\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 222,\n            columnNumber: 29\n          }, this)\n        }, void 0, false)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true);\n  }\n\n}\n\nexport default Events;","map":{"version":3,"sources":["/Users/kittabit/Desktop/occasiongenius/src/Pages/Events.js"],"names":["React","Component","Loading","Breadcrumbs","EventFilter","EventGridItem","ReactGA","Events","constructor","props","window","ogSettings","environment","api_base_url","fetchData","url","setState","isLoading","fetch","state","events_url","then","r","json","result","events","current_page","info","next_page","max_pages","catch","e","console","log","nextPage","scrollTo","top","behavior","prevPage","handleCategories","value","Array","from","target","selectedOptions","option","filter_categories","handleAreas","filter_areas","start_date","og_base_date","end_date","og_max_base_date","min_date","og_min_base_date","max_date","handleStartDate","bind","handleEndDate","handleSubmit","componentDidMount","Promise","all","res","cat_data","document","title","og_ga_ua","pageview","location","pathname","search","event","fetch_url","preventDefault","render","table","map","item","index"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport Loading from \"../Components/Loading\"\nimport Breadcrumbs from \"../Components/Breadcrumbs\"\nimport EventFilter from '../Components/EventFilter';\nimport EventGridItem from '../Components/EventGridItem';\nimport ReactGA from 'react-ga';\nclass Events extends Component {\n\n    constructor (props){\n\n        if(window.ogSettings.environment === \"dev\"){\n            var api_base_url = \"http://127.0.0.1:3000\";\n        }else{\n            var api_base_url = \"https://widgetapi.occasiongenius.com\";\n        }\n\n        super(props);\n        this.state = {\n            api_base_url: api_base_url,\n            current_page: [],\n            next_page: [],\n            max_pages: [],\n            events: [],\n            events_url: '/api/events/',\n            isLoading: 1,\n            start_date: window.ogSettings.og_base_date,\n            end_date: window.ogSettings.og_max_base_date,\n            min_date: window.ogSettings.og_min_base_date,\n            max_date: window.ogSettings.og_max_base_date,\n            filter_categories: '',\n            filter_areas: ''\n        }\n        \n        this.handleStartDate = this.handleStartDate.bind(this);\n        this.handleEndDate = this.handleEndDate.bind(this);\n        this.handleCategories = this.handleCategories.bind(this);\n        this.handleAreas = this.handleAreas.bind(this);\n        this.handleSubmit = this.handleSubmit.bind(this);\n    }\n    \n    componentDidMount() {\n\n        console.log(this.props.api_base_url + this.state.events_url);\n        \n        Promise.all([\n          fetch(this.props.api_base_url + this.state.events_url),\n        ])\n        .then(([res]) => Promise.all([res.json()]))\n        .then(([cat_data]) => this.setState({\n          events: cat_data,\n          current_page: cat_data.info.current_page, \n          next_page: cat_data.info.next_page, \n          max_pages: cat_data.info.max_pages, \n          isLoading: 0\n        }));\n\n        document.title = \"All Local Events\";\n\n        if(window.ogSettings.og_ga_ua){\n            ReactGA.pageview(window.location.pathname + window.location.search);\n        }          \n\n    } \n\n    fetchData = async (url) => {\n    \n        this.setState({\n            isLoading: 1\n        });\n        \n        await fetch(this.props.api_base_url + this.state.events_url)\n          .then((r) => r.json())\n          .then((result) => {\n            this.setState({\n                events: result,\n                current_page: result.info.current_page, \n                next_page: result.info.next_page, \n                max_pages: result.info.max_pages, \n                isLoading: 0\n            });\n          })\n          .catch((e) => {\n            console.log(e);\n          });\n    \n    };  \n    \n    // TODO:  Filtered Pagination\n    nextPage = () => {\n    \n        this.setState({\n            current_page: this.state.current_page + 1,\n            isLoading: 1\n          },\n          () => {\n            const events_url = this.props.api_base_url + this.state.events_url + this.state.current_page;\n            this.fetchData(events_url);\n            window.scrollTo({\n              top: 0,\n              behavior: \"smooth\"\n            });\n          }\n        );\n    \n    };\n    \n    prevPage = () => {\n    \n        this.setState({\n            current_page: this.state.current_page - 1,\n            isLoading: 1\n          },\n          () => {\n            const events_url = this.props.api_base_url + this.state.events_url + this.state.current_page;\n            this.fetchData(events_url);\n            window.scrollTo({\n              top: 0,\n              behavior: \"smooth\"\n            });\n          }\n        );\n    \n    };    \n\n    handleStartDate(event) {\n        this.setState({\n            start_date: event.target.value,\n            min_date: event.target.value\n        });\n    }\n\n    handleEndDate(event) {\n        this.setState({\n            end_date: event.target.value\n        });\n    }\n\n    handleCategories = (e) => {\n        let value = Array.from(e.target.selectedOptions, option => option.value);\n        this.setState({filter_categories: value});\n    }\n\n    handleAreas = (e) => {\n        let value = Array.from(e.target.selectedOptions, option => option.value);\n        this.setState({filter_areas: value});\n    }    \n\n    handleSubmit(event) {        \n        var fetch_url = \"/wp-json/occasiongenius/v1/events?limit=100&filter_start=\" + this.state.start_date + \"&filter_end=\" + this.state.end_date + \"&filter_flags=\" + this.state.filter_categories + \"&filter_areas=\" + this.state.filter_areas;\n        console.log(\":: Fetch: \" + fetch_url);\n\n        this.fetchData(fetch_url);\n        window.scrollTo({\n            top: 0,\n            behavior: \"smooth\"\n        });\n        event.preventDefault();\n    }\n\n    render(){\n\n        console.table(this.state.events);\n\n        const { current_page, next_page, max_pages } = this.state;\n\n        return (\n            <>\n\n                <Breadcrumbs parent_title=\"All Categories\" parent_url=\"/categories/\" page_name=\"All Local Events\" disable_all_events=\"true\" />\n                \n                <div className=\"col-span-12\">\n                    <div className=\"flow-root\">\n                        <p className=\"float-left text-gray-800 text-3xl font-semibold mb-4\">\n                            All Local Events\n                        </p>\n                    </div>\n                </div>                \n                    \n      \n                <div className=\"flex w-full flex-wrap\">                          \n                    <div className=\"flex flex-col md:w-1/5\">\n                        <EventFilter \n                            fetchData={this.fetchData}  \n                            handleStartDate={this.handleStartDate}\n                            handleEndDate={this.handleEndDate}\n                            handleCategories={this.handleCategories}\n                            handleAreas={this.handleAreas}\n                            handleSubmit={this.handleSubmit}\n                            start_date={this.state.start_date}\n                            end_date={this.state.end_date}\n                            min_date={this.state.min_date}\n                            max_date={this.state.max_date}\n                            />\n                    </div>\n\n                    <div className=\"flex flex-col md:w-4/5 items-center\">\n                        <div className=\"grid grid-cols-12 px-18 gap-5\">\n                            {this.state.isLoading ? (\n                                <Loading />\n                            ) : (\n                                <>                            \n                                    {this.state.events?.map((item, index) => (   \n                                        <EventGridItem item={item} key={index} />\n                                    ))}\n                                </>\n                            )}                                            \n                        </div>\n                    </div>\n                </div>\n\n                <div className=\"flex items-center flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-6 lg:space-x-8 mt-8 md:mt-16 mt-16\">\n                    {current_page > 1 &&\n                        <>\n                            <button onClick={this.prevPage} className=\"block w-full md:w-3/5 border border-gray-800 text-base font-medium leading-none text-white uppercase py-6 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-800 bg-gray-800 hover:text-white no-underline text-center\">\n                                Previous Page\n                            </button>\n                        </>\n                    }\n\n                    { next_page <= max_pages && max_pages !== current_page &&\n                        <>\n                            <button onClick={this.nextPage} className=\"block w-full md:w-3/5 border border-gray-800 text-base font-medium leading-none text-white uppercase py-6 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-800 bg-gray-800 hover:text-white no-underline text-center\">\n                                Next Page\n                            </button>                    \n                        </>\n                    }\n                </div>\n\n            </>\n        )\n    }\n}\n\nexport default Events"]},"metadata":{},"sourceType":"module"}